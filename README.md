# OldCordV3
Current code for OldCord (Rewritten) as typescript sucks for this kinda project.

# Credits
ziad - token generation, permissions, sessions references, and some middleware references <br>
Deskehs - electron client stuff & modern discord client shenanigans (Wumpdle, repacker & reupdater) <br>
dogsong - client patcher & the patches <br>
discord.js - snowflake <br>
noia - everything else <br>

# Important, read me!
Due to Oldcord's rapidly changing nature, there are some commits which may break your current database generated by the program. <br>
Which is why, on future commits where the db is changed in a significant way, I will add a short SQL query/queries you can run to update the Database to work with the new wrapper on the commit description. <br>

# Setup
Download and setup a postgreSQL server with the database name of your choice.
Download the config.json from the repository and modify the entries of your choice. Look below for a guide.

Run npm install and then node server.js to start Oldcord.

Since V3 is hosted on my own server at home, I use cloudflared to bypass CG-NAT and have enabled cloudflare's free SSL so the SSL stuff in the earlier configuration is kinda deprecated.

custom_invite_url is used for invites in the app, so, putting "oldcord.us" will make it so every invite made has the prefix oldcord.us - much like discord.gg, etc.

integration_config is for the in-app connections under user settings, currently only twitch is supported, and you need to make a twitch application which gives you a client_secret to use this.

Example integration configuration:
```
"integration_config" : [{
        "platform" : "twitch",
        "client_id" : "client_id",
        "client_secret" : "client_secret",
        "redirect_uri" : "https://staging.oldcordapp.com/api/connections/twitch/callback"
}]
```

trusted_users bypass short term rate-limits, use this to add specific users like bots from being blocked by the wacky rate-limits scattered across the project. <br>

instance_flags are kinda limited at the moment, but you can lock down an instance with these entries:

NO_REGISTRATION - Block all future users from creating an account on your instance. <br>
NO_GUILD_CREATION - Block future guilds from being created. <br>
NO_INVITE_USE - Block invites from being used. <br>

More are to come with instance flags in the future. 

# Long term goals of this project
- Support 2015, 2016, 2017, 2018 and 2019 fully. Not supporting 2020 as its the year discord was no longer old imo.
- Allow for users to create guilds for specific years - where the maximum support on the backend for channels, messages, invites, etc is only limited to what was available for that year.
- This will stop users from 2017 coming into 2015 servers spamming custom emojis or whatnot - as the requests will be rejected by the backend and the gateway will not dispatch any events for it.

# Community
We also have a discord server! You can join it here: https://discord.gg/HcpmWDxmzf
